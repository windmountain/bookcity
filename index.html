<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hamburger Lanes</title>
</head>
<body>
    <div id="app"></div>
    <script src="elm.js"></script>
    <script>
        var STORAGE_KEY = "hamburger-lanes-answers";

        function loadAll() {
            try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; }
            catch (e) { return {}; }
        }

        var app = Elm.Main.init({
            node: document.getElementById('app'),
            flags: loadAll()
        });

        app.ports.saveAnswer.subscribe(function(data) {
            var all = loadAll();
            all[data.key] = { debit: data.debit, credit: data.credit, amount: data.amount };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(all));
        });

        app.ports.clearAnswers.subscribe(function() {
            localStorage.removeItem(STORAGE_KEY);
        });
    </script>
</body>
</html>
